<%*
const sel = tp.file.selection();               // grab the selected text
if (!sel) { tR += "⚠️ No selection."; return; }

const id = "eq-" + Date.now();                 // unique block id
const srcName = tp.file.title;                 // current note title
const srcLink = `[[${srcName}]]`;

// --- 1) Replace selection in place ---
// Add tag + block ID, so it's discoverable and referenceable
const replacement = `${sel}\n#equation eqid:: ${id}\n^${id}\n`;
await tp.file.replace_selection(replacement);

// --- 2) Append embed to Master Equations (inside Core folder) ---
const master = "Core/Master Equations.md";     // <— updated path
const line = `### ${srcName}\nFrom ${srcLink}\n![[${srcName}#^${id}]]\n\n`;
await tp.file.append(line, master);

tR += `✅ Equation captured as ${id} and appended to ${master}`;
_%>
